<?php if (! defined('ABSPATH')) {
  exit;
} ?>

<!-- ================= Footer ================= -->

<footer class="bg-slate-950 text-white/90">
  <div class="relative w-full h-[500px] overflow-hidden
            bg-[url('https://sepandrah.bamdad.studio/wp-content/themes/sepandrah/assets/images/bg_footer_4.jpg')]
            bg-cover bg-center md:bg-fixed">
    <!-- Overlay برای خوانایی -->
    <div class="absolute inset-0 bg-linear-to-t from-slate-950 via-black/40 to-transparent"></div>

    <!-- محتوا -->
    <div class="relative z-10 h-full">
      <div class="container mx-auto max-w-7xl px-4 h-full">
        <div class="h-full flex items-center justify-center text-center">
          <div class="space-y-5 md:space-y-6">
            <h3 class="text-white font-extrabold leading-tight text-3xl">
             سپند راه آگرین همراه مطمئن شما در تجارت بین‌الملل
            </h1>
            <p class="text-white/90 text-xs md:text-base">
             از تأمین تا حمل و ترخیص—تحویل به‌موقع، شفافیت کامل و کاهش ریسک در زنجیره تأمین شما.
            </p>

<div class="pt-4">
  <a href="/contact" class="group inline-flex items-center gap-3 rounded-full bg-white text-slate-900 px-1 py-1 text-sm font-semibold shadow-lg transition-all duration-300 hover:shadow-xl hover:-translate-y-[1px]">
    <span class="ps-3">درخواست مشاوره</span>
    <span class="w-8 h-8 rounded-full bg-blue-800 text-white flex items-center justify-center transition-transform duration-300 group-hover:scale-110">
      <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-3">
      <path stroke-linecap="round" stroke-linejoin="round" d="m19.5 19.5-15-15m0 0v11.25m0-11.25h11.25" />
    </svg>

    </span>
  </a>
</div>

          </div>
        </div>
      </div>
    </div>
  </div>
  <!-- === Full-width Hero (بالای منو) === -->
  <div class="container mx-auto max-w-7xl">
    <!-- Middle: About + Links + Contact -->
    <div class="grid gap-10 md:grid-cols-4 py-18 px-10 md:px-0">
      <div class="col-span-2 md:col-span-1">
        <div class="flex items-center gap-3 mb-10">
          <div class="w-18 h-18 grid place-items-center text-white">
            <!-- <span class="text-sm font-extrabold tracking-widest">SRA</span> -->
            <img src="https://sepandrah.bamdad.studio/wp-content/themes/sepandrah/assets/images/logo_sepand_rah_white.svg" alt="سپند راه آگرین">
          </div>
          <div class="flex flex-col text-xs text-white/80 gap-1">
            <span class="text-base">سپند راه آگرین</span>
            <span>SEPAND RAH AGRIN</span>
          </div>
        </div>
        <p class="text-sm leading-7 text-white/80 text-justify">
          ارائه‌دهنده‌ی راهکارهای مطمئن و کارآمد در حمل‌ونقل بین‌المللی. از
          فورواردری تا ردیابی لحظه‌ای، کسب‌وکار شما را روان نگه می‌داریم.
        </p>
        <div class="flex gap-3 mt-5">
          <a
            class="w-auto h-9 grid place-items-center rounded-lg bg-white/10 hover:bg-white/15 transition"
            href="#"
            aria-label="Instagram">اینستاگرم
          </a>
        </div>
      </div>

      <div>
        <p class="font-semibold mb-3">خدمات</p>
        <ul class="space-y-2 text-sm text-white/80">
          <li><a href="#" class="hover:text-white">فریت فورواردینگ</a></li>
          <li>
            <a href="#" class="hover:text-white">انبارداری و توزیع</a>
          </li>
          <li><a href="#" class="hover:text-white">ترخیص کالا</a></li>
          <li><a href="#" class="hover:text-white">ردیابی لحظه‌ای</a></li>
          <li>
            <a href="#" class="hover:text-white">مدیریت زنجیره تامین</a>
          </li>
          <li><a href="#" class="hover:text-white">حمل چندوجهی</a></li>
        </ul>
      </div>

      <div>
        <p class="font-semibold mb-3">شرکت</p>
        <ul class="space-y-2 text-sm text-white/80">
          <li><a href="#about" class="hover:text-white">درباره ما</a></li>
          <li><a href="#team" class="hover:text-white">تیم</a></li>
          <li><a href="#services" class="hover:text-white">خدمات</a></li>
          <li>
            <a href="#cases" class="hover:text-white">مطالعات موردی</a>
          </li>
          <li>
            <a href="#quote" class="hover:text-white">استعلام قیمت</a>
          </li>
          <li><a href="#blog" class="hover:text-white">بلاگ</a></li>
        </ul>
      </div>

      <div>
        <p class="font-semibold mb-3">تماس</p>
        <ul class="space-y-2 text-sm text-white/80">
          <li>تهران، خیابان مثال، پلاک ۷۸۹، طبقه ۵</li>
          <li>کد پستی ۱۰۰۱۸</li>
          <li>021-0000-0000</li>
          <li>enquiries@spandrah.com</li>
        </ul>
      </div>
    </div>

    <hr class=" border-white/10" />

    <!-- Bottom bar -->
    <div
      class="flex flex-col md:flex-row items-center justify-between gap-4 py-6 text-xs text-white/60">
      <p>© 2025 Spand Rah Agrin. کلیه حقوق محفوظ است.</p>
      <div class="flex items-center gap-6">
        <a href="#" class="hover:text-white/80">حریم خصوصی</a>
        <a href="#" class="hover:text-white/80">شرایط استفاده</a>
        <a href="#" class="hover:text-white/80">تنظیمات کوکی</a>
      </div>
    </div>
  </div>
</footer>

<!-- دکمه بازگشت به بالا -->
<div id="scrollTopBtn"
  class="fixed bottom-6 right-6 z-50 opacity-0 pointer-events-none group cursor-pointer inline-flex items-center gap-3 rounded-full text-slate-900 text-sm font-semibold shadow-lg transition-all duration-300 hover:shadow-xl hover:-translate-y-[1px]">
  <span
    class="w-12 h-12 rounded-full bg-slate-900/40 text-white flex items-center justify-center transition-transform duration-300 group-hover:scale-110 group-hover:bg-slate-900">
    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"
      stroke-width="1.5" stroke="currentColor" class="size-3">
      <path stroke-linecap="round" stroke-linejoin="round"
        d="M4.5 10.5 12 3m0 0 7.5 7.5M12 3v18" />
    </svg>
  </span>
</div>


<!-- =============== Scripts =============== -->
<script src="https://cdn.jsdelivr.net/npm/gsap@3.12.5/dist/gsap.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/gsap@3.12.5/dist/ScrollTrigger.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/gsap@3.13.0/dist/ScrollToPlugin.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/swiper@12/swiper-bundle.min.js"></script>
<script src="https://unpkg.com/lenis@1.3.13/dist/lenis.min.js"></script>
<script>
  // Initialize Lenis
  const lenis = new Lenis({
    autoRaf: true,
  });

  // Listen for the scroll event and log the event data
  lenis.on("scroll", (e) => {
    console.log(e);
  });

  // Home Scroll
  // فرض: gsap از قبل لود شده
  gsap.registerPlugin(ScrollToPlugin);

  const headerOffset = 72; // اگر هدر ثابت داری، فاصله‌ی دلخواه از بالا
  const targetSelector = "#services"; // سکشنی که می‌خوای بهش اسکرول بشه

  const btn = document.getElementById("scrollDownBtn");
  if (btn) {
    const goDown = (e) => {
      e.preventDefault();
      gsap.to(window, {
        duration: 1,
        ease: "power2.out",
        scrollTo: {
          y: targetSelector,
          offsetY: headerOffset,
          autoKill: true,
        },
      });
    };

    btn.addEventListener("click", goDown);
    // دسترسی بهتر: با Enter/Space هم اسکرول کن
    btn.addEventListener("keydown", (e) => {
      if (e.key === "Enter" || e.key === " ") goDown(e);
    });
  }

  // Navbar entrance
  gsap.from(".topnav", {
    y: -24,
    opacity: 0,
    duration: 0.6,
    ease: "power3.out",
    delay: 0.2,
  });

  // فرض: gsap و Swiper قبلاً لود شده‌اند
  const progressCircle = document.querySelector(".autoplay-progress svg");
  const progressContent = document.querySelector(".autoplay-progress span");

  const swiper = new Swiper(".slider", {
    slidesPerView: 1,
    effect: "fade",
    speed: 900,
    autoplay: {
      delay: 4000,
      disableOnInteraction: false
    },
    pagination: {
      el: ".swiper-pagination",
      clickable: true
    },
    rewind: true,
    keyboard: {
      enabled: true,
    },
    navigation: {
      nextEl: ".hero-next",
      prevEl: ".hero-prev",
    },
    on: {
      init(s) {
        // همه‌ی متن‌ها پنهان، متن اسلاید فعال نمایان
        const slides = s.slides;
        slides.forEach((sl) =>
          gsap.set(sl.querySelector(".slide-content"), {
            autoAlpha: 0,
            y: 15,
          })
        );
        gsap.set(slides[s.activeIndex].querySelector(".slide-content"), {
          autoAlpha: 1,
          y: 0,
        });

        // زوم اولیه‌ی مدیای اسلاید فعال
        const activeMedia =
          slides[s.activeIndex].querySelector(".hero-slide > *");
        gsap.set(activeMedia, {
          scale: 1
        });
        gsap.to(activeMedia, {
          scale: 1.06,
          duration: 4,
          ease: "power1.out",
        });
      },
      slideChangeTransitionStart(s) {
        const prev = s.slides[s.previousIndex];
        const next = s.slides[s.activeIndex];

        // متن قبلی مخفی
        if (prev) {
          gsap.to(prev.querySelector(".slide-content"), {
            autoAlpha: 0,
            y: 15,
            duration: 0.4,
            ease: "power2.out",
          });
          gsap.to(prev.querySelector(".hero-slide > *"), {
            scale: 1,
            duration: 0.8,
            ease: "power2.out",
          });
        }

        // متن بعدی با fade + slide-up
        gsap.fromTo(
          next.querySelector(".slide-content"), {
            autoAlpha: 0,
            y: 15
          }, {
            autoAlpha: 1,
            y: 0,
            duration: 0.7,
            ease: "power3.out",
            delay: 0.1,
          }
        );

        // زوم خیلی نرم روی تصویر/ویدئوی اسلاید فعال
        const media = next.querySelector(".hero-slide > *");
        gsap.fromTo(
          media, {
            scale: 1
          }, {
            scale: 1.02,
            duration: 4,
            ease: "power1.out"
          }
        );
      },
      autoplayTimeLeft(s, time, progress) {
        progressCircle.style.setProperty("--progress", 1 - progress);
        progressContent.textContent = `${Math.ceil(time / 1000)}s`;
      },
    },
  });
</script>

<script>
  const projSwiper = new Swiper(".projects-swiper", {
    speed: 700,
    spaceBetween: 24,
    slidesPerView: 1.1, // موبایل
    centeredSlides: false,
    navigation: {
      nextEl: ".proj-next",
      prevEl: ".proj-prev"
    },
    breakpoints: {
      640: {
        slidesPerView: 1.6,
        spaceBetween: 20
      },
      768: {
        slidesPerView: 2,
        spaceBetween: 22
      },
      1024: {
        slidesPerView: 3,
        spaceBetween: 24
      }, // دسکتاپ: ۳ آیتم
    },
  });
</script>

<script>
  const servicesSwiper = new Swiper(".services-swiper", {
    loop: true,
    speed: 700,
    spaceBetween: 24,
    slidesPerView: 1.05, // موبایل: نزدیک به تمام عرض
    centeredSlides: false,
    pagination: {
      el: ".swiper-pagination",
      clickable: true,
    },
    navigation: {
      nextEl: ".service-next",
      prevEl: ".service-prev"
    },
    // اگر AutoPlay خواستی: autoplay: { delay: 4500, disableOnInteraction: false },
    breakpoints: {
      640: {
        slidesPerView: 1.5,
        spaceBetween: 24
      }, // موبایل بزرگ
      768: {
        slidesPerView: 2.5,
        spaceBetween: 28
      }, // تبلت
      1024: {
        slidesPerView: 3.5,
        spaceBetween: 32
      }, // دسکتاپ: حداقل ۳ کارت
      1440: {
        slidesPerView: 4.5,
        spaceBetween: 36
      }, // نمایش وسیع‌تر
    },
  });
</script>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    const mobileBtn = document.querySelector(".mobile-menu-btn");
    const mobileNav = document.getElementById("mobileNav");
    const overlay = mobileNav?.querySelector(".overlay");
    const panel = document.getElementById("mobileNavPanel");
    const closeBtn = document.querySelector(".close-mobile");
    const topnav = document.querySelector(".topnav");

    // ---- GSAP guard
    const hasGSAP = typeof window.gsap !== 'undefined';
    if (hasGSAP) {
      gsap.set(panel, {
        x: "100%"
      });
      gsap.set(overlay, {
        opacity: 0,
        pointerEvents: "none"
      });
    } else {
      if (panel) panel.style.transform = "translateX(100%)";
      if (overlay) {
        overlay.style.opacity = "0";
        overlay.style.pointerEvents = "none";
      }
    }

    function openMobile() {
      mobileNav.classList.remove("hidden");
      panel?.setAttribute("aria-hidden", "false");
      mobileBtn?.setAttribute("aria-expanded", "true");
      document.body.style.overflow = "hidden";
      if (hasGSAP) {
        const tl = gsap.timeline();
        tl.to(overlay, {
            duration: .28,
            opacity: .6,
            pointerEvents: "auto",
            ease: "power2.out"
          }, 0)
          .to(panel, {
            duration: .38,
            x: "0%",
            ease: "power3.out"
          }, 0);
      } else {
        overlay.style.opacity = ".6";
        overlay.style.pointerEvents = "auto";
        panel.style.transform = "translateX(0%)";
      }
    }

    function closeMobile() {
      if (hasGSAP) {
        const tl = gsap.timeline({
          onComplete() {
            mobileNav.classList.add("hidden");
            panel?.setAttribute("aria-hidden", "true");
          }
        });
        tl.to(panel, {
            duration: .28,
            x: "100%",
            ease: "power2.in"
          }, 0)
          .to(overlay, {
            duration: .28,
            opacity: 0,
            pointerEvents: "none",
            ease: "power2.in"
          }, 0);
      } else {
        panel.style.transform = "translateX(100%)";
        overlay.style.opacity = "0";
        overlay.style.pointerEvents = "none";
        mobileNav.classList.add("hidden");
        panel?.setAttribute("aria-hidden", "true");
      }
      mobileBtn?.setAttribute("aria-expanded", "false");
      document.body.style.overflow = "";
    }
    mobileBtn?.addEventListener("click", openMobile);
    closeBtn?.addEventListener("click", closeMobile);
    overlay?.addEventListener("click", closeMobile);

    // Header scroll
    const onScroll = () => {
      if (window.scrollY > 20) topnav?.classList.add("scrolled");
      else topnav?.classList.remove("scrolled");
    };
    onScroll();
    window.addEventListener("scroll", onScroll);

    // =========== MOBILE: toggles ===========
    const mobileMenu = document.getElementById('mobile-primary');
    if (mobileMenu) {
      mobileMenu.querySelectorAll('li.menu-item-has-children').forEach((li) => {
        const a = li.querySelector(':scope > a');
        const sub = li.querySelector(':scope > .sub-menu');
        if (!sub) return;

        sub.setAttribute('data-open', 'false');

        const btn = document.createElement('button');
        btn.type = 'button';
        btn.className = 'parent-toggle flex items-center justify-between w-full';
        btn.setAttribute('aria-expanded', 'false');

        const id = li.id ? `sub-${li.id}` : `sub-${Math.random().toString(36).slice(2)}`;
        sub.id = sub.id || id;
        btn.setAttribute('aria-controls', sub.id);

        btn.innerHTML = `
        <span class="text-right flex-1">${a ? a.textContent : '—'}</span>
        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M6 9l6 6 6-6"/></svg>
      `;

        if (a) a.style.display = 'none';
        li.insertBefore(btn, sub);

        btn.addEventListener('click', () => {
          const isOpen = sub.getAttribute('data-open') === 'true';
          // close others
          mobileMenu.querySelectorAll('.sub-menu[data-open="true"]').forEach((other) => {
            if (other !== sub) {
              other.setAttribute('data-open', 'false');
              const otherBtn = other.previousElementSibling;
              if (otherBtn && otherBtn.matches('.parent-toggle')) {
                otherBtn.setAttribute('aria-expanded', 'false');
              }
            }
          });
          sub.setAttribute('data-open', String(!isOpen));
          btn.setAttribute('aria-expanded', String(!isOpen));
          // نمایش/مخفی ساده
          sub.style.display = isOpen ? 'none' : 'block';
        });
      });
    }

    // =========== DESKTOP: submenu prepare (two-columns + caret) ===========
    const desktopMenu = document.querySelector('.menu-desktop');
    if (desktopMenu) {
      // 1) والد‌ها relative
      desktopMenu.querySelectorAll('li.menu-item-has-children').forEach(li => {
        li.classList.add('relative');
      });

      // 2) دو ستونه در صورت >6 آیتم + استایل لینک‌های داخلی
      desktopMenu.querySelectorAll('li.menu-item-has-children > .sub-menu').forEach((dd) => {
        const items = dd.querySelectorAll(':scope > li');
        if (items.length > 6) dd.classList.add('two-cols');
        else dd.classList.remove('two-cols');

        dd.querySelectorAll(':scope > li > a').forEach(a => {
          a.classList.add('block', 'px-3', 'py-2', 'rounded-lg', 'hover:bg-slate-50', 'text-sm', 'text-slate-700');
        });
      });

      // 3) افزودن فلش به والد‌هایی که ندارند
      desktopMenu.querySelectorAll('li.menu-item-has-children > a').forEach((a) => {
        if (!a.querySelector('.caret')) {
          const svg = document.createElementNS("http://www.w3.org/2000/svg", "svg");
          svg.setAttribute("viewBox", "0 0 24 24");
          svg.setAttribute("width", "14");
          svg.setAttribute("height", "14");
          svg.classList.add("caret");
          svg.innerHTML = '<path d="M6 9l6 6 6-6" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>';
          a.appendChild(svg);
          a.classList.add('inline-flex', 'items-center', 'gap-1');
        }
      });

      // =========== DESKTOP: open/close ===========
      desktopMenu.querySelectorAll("li.menu-item-has-children").forEach((li) => {
        const trigger = li.querySelector(':scope > a');
        const dd = li.querySelector(':scope > .sub-menu');
        if (!trigger || !dd) return;

        trigger.setAttribute('aria-haspopup', 'true');
        trigger.setAttribute('aria-expanded', 'false');

        function closeAll() {
          desktopMenu.querySelectorAll(".sub-menu.open").forEach((other) => {
            if (other !== dd) {
              other.classList.remove('open');
              const ob = other.previousElementSibling;
              if (ob && ob.tagName === 'A') ob.setAttribute('aria-expanded', 'false');
            }
          });
        }

        trigger.addEventListener('click', (e) => {
          e.preventDefault(); // اگر می‌خوای لینک باشد، فلش جدا بساز
          const opening = !dd.classList.contains('open');
          closeAll();
          dd.classList.toggle('open', opening); // این خط نمایش را کنترل می‌کند
          trigger.setAttribute('aria-expanded', String(opening));
        });

        trigger.addEventListener('keydown', (e) => {
          if (e.key === 'Enter' || e.key === ' ') {
            e.preventDefault();
            trigger.click();
          }
          if (e.key === 'Escape') {
            dd.classList.remove('open');
            trigger.setAttribute('aria-expanded', 'false');
            trigger.focus();
          }
        });
      });

      // کلیک بیرون: بستن
      document.addEventListener('click', (e) => {
        if (!e.target.closest('.menu-desktop li.menu-item-has-children')) {
          desktopMenu.querySelectorAll(".sub-menu.open").forEach((dd) => {
            dd.classList.remove('open');
            const t = dd.previousElementSibling;
            if (t && t.tagName === 'A') t.setAttribute('aria-expanded', 'false');
          });
        }
      });
      // ESC: بستن
      document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape') {
          desktopMenu.querySelectorAll(".sub-menu.open").forEach((dd) => {
            dd.classList.remove('open');
            const t = dd.previousElementSibling;
            if (t && t.tagName === 'A') t.setAttribute('aria-expanded', 'false');
          });
        }
      });

      // در صورت تغییر اندازه: دوباره چکِ ستون‌ها
      window.addEventListener('resize', () => {
        desktopMenu.querySelectorAll('li.menu-item-has-children > .sub-menu').forEach((dd) => {
          const items = dd.querySelectorAll(':scope > li');
          if (items.length > 6) dd.classList.add('two-cols');
          else dd.classList.remove('two-cols');
        });
      });
    }
  });
</script>


<script>
  document.addEventListener("DOMContentLoaded", () => {
    const btn = document.getElementById("scrollTopBtn");
    let isVisible = false;

    window.addEventListener("scroll", () => {
      if (window.scrollY > 200 && !isVisible) {
        isVisible = true;
        gsap.to(btn, { duration: 0.6, opacity: 1, y: 0, pointerEvents: "auto", ease: "power1.out" });
      } else if (window.scrollY <= 200 && isVisible) {
        isVisible = false;
        gsap.to(btn, { duration: 0.6, opacity: 0, y: 50, pointerEvents: "none", ease: "power1.in" });
      }
    });

    btn.addEventListener("click", () => {
      gsap.to(window, { duration: 1.2, scrollTo: { y: 0 }, ease: "power2.inOut" });
    });
  });
</script>

</body>

</html>